$(function(){function a(a,e,t){var n="";n=null==$.user.uid?0:$.user.uid,window.sa&&sa.track(a,{product:"web",UID:String(n),channel:$.getQueryString("channel")||"",userLevel:String($.user.level),client:"Web",refer_code:e,page:t})}function e(a){a=a?a:window.event?window.event:null;var e=t();if("IE"==e){var n=a.clientY||a.target.event.clientY,i=a.altKey||a.target.event.altKey;(0>n||i)&&window.ChatRoomID&&AcfunChat.events.publish("quiteRoom",{roomInfo:window.ChatRoomID,isRefresh:!0})}else{var o=a.currentTarget.document.activeElement.nodeName;"A"!=o&&window.ChatRoomID&&AcfunChat.events.publish("quiteRoom",{roomInfo:window.ChatRoomID,isRefresh:!0})}}function t(){var a=navigator.userAgent,e=a.indexOf("Opera")>-1;return e?"Opera":a.indexOf("Firefox")>-1?"FF":a.indexOf("Chrome")>-1?"Chrome":a.indexOf("Safari")>-1?"Safari":a.indexOf("compatible")>-1&&a.indexOf("MSIE")>-1&&!e?"IE":void 0}function n(){null===$.cookie("isCloseVisit")&&$.appguide.show()}$(".block-video .has-danmu").showDanmu(),$(".module-video-big .has-danmu").showDanmu({lines:5,lineHeight:30});var i=window.Weblog&&new Weblog;i.plug(Weblog.builtIns.impr),window.weblog=i;var o,d=function(a,e,t){var n=a,i=n.data().nav,o=n.closest("[data-tab]");e&&e(),n.addClass("active").siblings("a").removeClass("active"),o.find("[data-con]").addClass("hidden").filter('[data-con="'+i+'"]').removeClass("hidden")};$("[data-nav]").click(function(){var a=$(this),e=a.data().nav,t=a.closest("[data-tab]");t.hasClass("module-article")?d(a,function(){if(a.hasClass("active")){var t="/v/list"+e+"/index.htm";t=window.globalConfig.rootDomain?window.globalConfig.rootDomain+t:t,a.attr("href",t).attr("target","_blank")}else a.attr("href","javascript:;").removeAttr("target")}):d(a)}),$(".area-banana-rank .column-right .module-tab").on("mouseenter","a",function(){var a=$(this),e=a.data().nav,t=a.closest("[data-tab]");clearTimeout(o),o=setTimeout(function(){t.hasClass("module-article")?d(a,function(){if(a.hasClass("active")){var t="/v/list"+e+"/index.htm";t=window.globalConfig.rootDomain?window.globalConfig.rootDomain+t:t,a.attr("href",t).attr("target","_blank")}else a.attr("href","javascript:;").removeAttr("target")}):d(a)},150)});var r=$("#slider-big"),c=r.find(".slider-item"),l=r.find(".slider-con"),s=c.length;if(s>1){for(var g="",m=0;s>m;m++)g+="<span>"+(m+1)+"</span>";r.append('<div class="slider-count">'+g+"</div>");var f,h=0,u=function(a){var e=c.width();l.width(c.width()*s),l.animate({left:-e*a}),r.find(".slider-count span").eq(a).addClass("active").siblings("span").removeClass("active")},w=function(){f=setInterval(function(){u(h),h>=s-1?h=0:h++},3e3)};u(0),w(),r.hover(function(){clearInterval(f)},function(){h>=s-1?h=0:h++,w()}),r.on("click",".slider-con a",function(){var a=$(this);window.weblog&&weblog.track("CLICK_CAROUSEL_IMAGE",{is_ad:void 0!==a.data().ad?a.data().ad:0,name:a.attr("title")||"",link:a.attr("href"),index:a.parent("li").index()+1})}),r.on("click",".slider-count span",function(){h=$(this).index(),u(h)})}window.sa&&sa.track("HomePage",{from:document.referrer,firstPage:window.saObj.isFirstPage});var p=$(".area-monkey .crop-margin");p.delegate(".block-video","click",function(){var a=$(this),e=a.find("a").data();window.weblog&&window.weblog.track("click_recommend_cotent",{channel_id:0,channel_name:"首页",id:e.info.mediaId,name:e.info.title||"",position:"monkey_recommend"})});var p=$(".slider-small");p.delegate("li","click",function(){var a=$(this),e=a.find("a").data();window.weblog&&window.weblog.track("click_recommend_cotent",{channel_id:0,channel_name:"首页",id:e.info.mediaId,name:e.info.title||"",position:"carousel_right"})});var v=$(".area-ad");v.delegate("a","click",function(){var a=$(this),e=a.parents(".area-ad").find("a").length,t=a.data();window.weblog&&window.weblog.track("click_banner",{channel_id:0,channel_name:"首页",is_ad:void 0!==a.attr("data-ad")?a.attr("data-ad"):0,name:t.title||"",index:a.index()+1,position:e>1?"home_double_recommend":"home_recommend",link:a.attr("href")})});var b=$(".banana-ad");b.delegate("a","click",function(){var a=(b.find("a").length,$(this)),e=a.data();window.weblog&&window.weblog.track("click_banner",{channel_id:0,channel_name:"首页",is_ad:1,name:e.title||"",index:1,position:"home_banana_list",link:a.attr("href")})}),$(".area-monkey .pic-box").click(function(){var a=$(this),e=a.find("a");window.weblog&&weblog.track("click_operation_content",{is_ad:0,name:e.attr("title")||"",link:e.attr("href"),index:1,position:"home_monkey_right"})}),$(".J_niudannav").off("click").on("click",function(){a("web_click","web_home_navigation_gashapon","page_home")}),$(".J_niudan").off("click").on("click",function(){a("web_click","web_videodetai_svideodetail_gashapon","page_videodetail")});var _=function(){var a=$("#temp-change-video").html(),e=$(a).addClass("[recommendClass]");return e[0].outerHTML}();$(".area-change-btn span").click(function(){var a=$(this),e=a.closest(".area-channel"),t=e.find(".module-video"),n=e.attr("data-cid"),i=t.attr("data-pagecount"),o=parseInt(t.attr("data-showlength")),d=e.find("script.json-channel-change"),r=e.find("script.json-channel-adlist"),c=a.closest(".area-change-btn"),l=50;if(c.hasClass("loading"))return!1;a.data().page=a.data().page||0,a.data().recommendData=$.parseJson(e.find("script.json-channel-recommend").html())||[],a.data().recommendData=$.parseJson(e.find("script.json-channel-recommend").html())||[],a.data().recommendPage=void 0==a.data().recommendPage?0:a.data().recommendPage,a.data().changeData=a.data().changeData||[],a.data().changeDataOld=$.parseJson(d.html())||[],a.data().adList=$.parseJson(r.html())||[],a.data().changeStart=a.data().changeStart||0;var s={start:function(){c.addClass("loading")},stop:function(){setTimeout(function(){c.removeClass("loading")},1e3)}};s.start();var g=function(){var e=a.data().recommendPage,t=a.data().recommendData.slice(e*i,(e+1)*i);return t.length<=0&&(a.data().recommendPage=0,e>0&&(t=g())),t};a.data().recommendPage+=1;var m=function(){var e=g(),t=[],n=o-e.length,i=a.data().changeStart+n,d=a.data().changeData.slice(a.data().changeStart,i),r=a.data().adList,c=n-d.length;if(c>0){if(!a.data().lock)return u(function(){h()}),!1;var l=a.data().changeData.slice(0,c);d=d.concat(l),i=c}return a.data().changeStart=i,e=e.concat(d).sort(function(){return Math.random()>.5?-1:1}),t=f(e,r)},f=function(a,e){for(var t,n=[],i=(a.slice(0,a.length),a.length),o=0;o<e.length;o++)t=e[o],t&&t.adRank&&(n[t.adRank-1]=t);a=a.filter(function(a){return a&&a.adRank>0?!1:!0});for(var d=0;i>d;d++)n[d]||(n[d]=a.shift());return n},h=function(){var a=m();if(a){var e="";$.each(a,function(a,t){t&&(t.isCrown&&(t.recommendClass=t.isCrown?"is-recommend":""),e+=$.parseTemp(_,t))}),t.html(e),t.find("img[data-original]").lazyload({threshold:200,effect:"fadeIn",failure_limit:50}),s.stop()}},u=function(e){$.getHttp("/index/change",{channelId:n,page:a.data().page+1},function(t){var n=t.data,i=n.hits,o=[];n.total<l?(a.data().lock=!0,o=$.removeRepeatObject(a.data().changeDataOld,i,"mediaId"),o=o.concat(a.data().changeDataOld)):o=i,a.data().page=a.data().page+1,o=$.removeRepeatObject(a.data().recommendData,o,"mediaId");var d=[];d=1==a.data().page?a.data().changeDataOld:a.data().changeData,o=$.removeRepeatObject(d,o,"mediaId"),a.data().changeData=a.data().changeData.concat(o),e&&e()},function(){s.stop(),$.info.error("获取数据失败!")})};h()}),$(".indexMonkeyRightAd").click(function(){window.sa&&sa.track("JD618_PC")});var k=function(){var a,e,t,n,i,o=12,d=$("#christmas .close-btn");i=function(){$("#christmas").hide(),localStorage.christmasDefault=1},d.on("click",function(){i()}),a=Date.parse(new Date),e=14825808e5,t=14826816e5,1!=localStorage.christmasDefault&&parseInt(a)>e&&parseInt(a)<t&&$("#christmas").show(),(n=function(a){d.html("跳过动画("+a+")"),0==a?i():(setTimeout(function(){n(a)},1e3),a--)})(o)};k(),$.creditCardEntry=function(){var a={name:"click_credit_card_button",client_timestamp:(new Date).getTime(),params:{}};window.weblog&&weblog.log.sendData({data:[{type:"click",data:a}],async:!1})},window.onbeforeunload=function(a){try{return e(a)}catch(t){}};var C=function(){$("[data-impr-config]").map(function(a,e){if(Weblog.dom.inViewport(e)){var t=$(e),n=t.data().imprConfig,i=[],o=weblog.impr.generateReqID(e);t.find(n.selector+"[data-show!=true]").map(function(a,t){if(Weblog.dom.inViewport(t)&&Weblog.dom.inViewport(t,e)){$(t).attr("data-show",!0);var n=$(t).find("a").eq(0).data().wbinfo;i.push({group_id:o+"_"+(a+1),atom_id:n.atomid?String(n.atomid):"0",ac_id:n.mediaId?String(n.mediaId):"0",album_id:n.albumId?String(n.albumId):"0"})}}),i.length>0&&weblog.sendImmediately("CLIENT_IMPR",{req_id:o,group_list:i},"SHOW_EVENT")}})};C();var I=Weblog.util.debounce(C,300);$(window).on("scroll",I);var x=$("#qrcode").width();$("#qrcode").qrcode({render:"canvas",text:"http://m.acfun.cn/app/download?from=homepage",width:x,height:x,background:"#ffffff",foreground:"#000000",src:window.globalConfig.path+"/img/appicon.png",imgWidth:x/3.5,imgHeight:x/3.5}),$(window).resize(function(){var a=$("#qrcode").width();$("#qrcode").html(""),$("#qrcode").qrcode({render:"canvas",text:"http://m.acfun.cn/app/download?from=homepage",width:a,height:a,background:"#ffffff",foreground:"#000000",src:window.globalConfig.path+"/img/appicon.png",imgWidth:a/3.5,imgHeight:a/3.5})}),$.appguide={ieshow:function(){$("#appguideBox").animate({left:"0px"},2e3)},iehide:function(){$("#appguideBox").animate({left:"-3000px"},2e3)},show:function(){if("IE"==t()){var a=new RegExp("MSIE (\\d+\\.\\d+);");a.test(navigator.userAgent);var e=parseFloat(RegExp.$1);9>e?this.ieshow():$("#appguideBox").addClass("showguidebox")}else $("#appguideBox").addClass("showguidebox");window.weblog&&weblog.sendImmediately("DOWNLOAD_APP_BANNER",{},"SHOW_EVENT"),this.hide()},hide:function(){var a=this;$("#guideClose").off().click(function(){if("IE"==t()){var e=new RegExp("MSIE (\\d+\\.\\d+);");e.test(navigator.userAgent);var n=parseFloat(RegExp.$1);9>n?a.iehide():$("#appguideBox").addClass("hideguidebox")}else $("#appguideBox").addClass("hideguidebox");$.cookie("isCloseVisit",!1,{expires:365,path:"/",domain:".acfun.cn"}),window.weblog&&weblog.sendImmediately("CLICK_CLOSE_BUTTON",{})})}},n()});